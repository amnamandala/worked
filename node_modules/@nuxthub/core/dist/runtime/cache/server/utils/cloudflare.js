import { createCloudflareAPI, handleCloudflareError } from "../../../utils/cloudflare.js";
export async function bulkDeleteCacheKeys(accountId, apiToken, namespaceId, keys) {
  const $api = createCloudflareAPI(accountId, apiToken);
  for (let i = 0; i < keys.length; i += 1e4) {
    const chunk = keys.slice(i, i + 1e4);
    await $api(`/storage/kv/namespaces/${namespaceId}/bulk/delete`, {
      method: "POST",
      body: chunk,
      onResponseError: ({ response }) => handleCloudflareError({ data: response._data, status: response.status }, "Failed to delete cache keys")
    });
  }
}
